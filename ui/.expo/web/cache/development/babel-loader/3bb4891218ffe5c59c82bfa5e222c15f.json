{"ast":null,"code":"import { put, take } from 'redux-saga/effects';\nimport { navigate } from \"../../navigation/nav-ref\";\nexport function* callApi(apiCall) {\n  var response = yield apiCall;\n  if (!isUnauthorized(response)) {\n    return response;\n  }\n  yield put({\n    type: 'RELOGIN'\n  });\n  navigate('LoginScreen');\n  var action = yield take(['RELOGIN_OK', 'RELOGIN_ABORT']);\n  if (action.type === 'RELOGIN_ABORT') {\n    return response;\n  }\n  return yield apiCall;\n}\nfunction isUnauthorized(resp) {\n  return resp.status === 401;\n}","map":{"version":3,"names":["put","take","navigate","callApi","apiCall","response","isUnauthorized","type","action","resp","status"],"sources":["/Users/albertodelazzari/repositories/ambulanza_veloce/ui/app/shared/sagas/call-api.saga.js"],"sourcesContent":["import { put, take } from 'redux-saga/effects'\n\nimport { navigate } from '../../navigation/nav-ref';\n\n// this saga is used for showing the LoginScreen when a 401 error is received\n// if login is successful, it will reattempt the request\n// if login fails, it will return the error\nexport function * callApi (apiCall) {\n  const response = yield apiCall\n  if (!isUnauthorized(response)) {\n    return response\n  }\n  // this triggers your UI to show a login form\n  yield put({ type: 'RELOGIN' })\n\n  navigate('LoginScreen')\n  const action = yield take(['RELOGIN_OK', 'RELOGIN_ABORT'])\n\n  if (action.type === 'RELOGIN_ABORT') {\n    return response\n  }\n\n  // this re-calls the api with the new authorization\n  return yield apiCall\n}\n\nfunction isUnauthorized (resp) {\n  return resp.status === 401\n}\n"],"mappings":"AAAA,SAASA,GAAG,EAAEC,IAAI,QAAQ,oBAAoB;AAE9C,SAASC,QAAQ;AAKjB,OAAO,UAAWC,OAAOA,CAAEC,OAAO,EAAE;EAClC,IAAMC,QAAQ,GAAG,MAAMD,OAAO;EAC9B,IAAI,CAACE,cAAc,CAACD,QAAQ,CAAC,EAAE;IAC7B,OAAOA,QAAQ;EACjB;EAEA,MAAML,GAAG,CAAC;IAAEO,IAAI,EAAE;EAAU,CAAC,CAAC;EAE9BL,QAAQ,CAAC,aAAa,CAAC;EACvB,IAAMM,MAAM,GAAG,MAAMP,IAAI,CAAC,CAAC,YAAY,EAAE,eAAe,CAAC,CAAC;EAE1D,IAAIO,MAAM,CAACD,IAAI,KAAK,eAAe,EAAE;IACnC,OAAOF,QAAQ;EACjB;EAGA,OAAO,MAAMD,OAAO;AACtB;AAEA,SAASE,cAAcA,CAAEG,IAAI,EAAE;EAC7B,OAAOA,IAAI,CAACC,MAAM,KAAK,GAAG;AAC5B"},"metadata":{},"sourceType":"module"}